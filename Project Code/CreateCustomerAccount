from datetime import date
from typing import Optional, List, TYPE_CHECKING
if TYPE_CHECKING:
    from CreateTransaction import Transaction

class Customer:
    def __init__(self, customerID: str, username: str, password: str, name: str, phoneNo: str, email: str, joinDate: Optional[date] = None, points: int = 10):
        self.customerID = customerID
        self.username = username
        self.password = password
        self.name = name
        self.phoneNo = phoneNo
        self.email = email
        self.joinDate = joinDate or date.today()
        self.points = points
        self.addresses: List['Address'] = []
        self.creditCards: List['CreditCard'] = []
        self.transactions: List['Transaction'] = []

    def addAddress(self, address: 'Address'):
        self.addresses.append(address)

    def addCreditCard(self, creditCard: 'CreditCard'):
        self.creditCards.append(creditCard)

    def addTransaction(self, transaction: 'Transaction'):
        self.transactions.append(transaction)
        newPoints = transaction.calculatePoints()
        self.addPoints(newPoints)

    def confirmPassword(self, confirmPassword: str) -> bool:
        return self.password == confirmPassword

    def editAccountDetails(self, username: Optional[str] = None, password: Optional[str] = None,
                           name: Optional[str] = None, phoneNo: Optional[str] = None, email: Optional[str] = None):
        if username is not None:
            self.username = username
        if password is not None:
            self.password = password
        if name is not None:
            self.name = name
        if phoneNo is not None:
            self.phoneNo = phoneNo
        if email is not None:
            self.email = email

    def addPoints(self, newPoints: int):
        self.points += newPoints

class Address:
    def __init__(self, streetNo: int, street: str, city: str, state: str, zip: int, apartNo: Optional[int] = None):
        self.streetNo = streetNo
        self.street = street
        self.city = city
        self.state = state
        self.zip = zip
        self.apartNo = apartNo

    def editAddress(self, streetNo: Optional[int] = None, street: Optional[str] = None, 
                    city: Optional[str] = None, state: Optional[str] = None, 
                    zip: Optional[int] = None, apartNo: Optional[int] = None):
        if streetNo is not None:
            self.streetNo = streetNo
        if street is not None:
            self.street = street
        if city is not None:
            self.city = city
        if state is not None:
            self.state = state
        if zip is not None:
            self.zip = zip
        if apartNo is not None:
            self.apartNo = apartNo

class CreditCard:
    def __init__(self, creditCardNo: str, name: str, expDate: date, cvv: int):
        self.creditCardNo = creditCardNo
        self.name = name
        self.expDate = expDate
        self.cvv = cvv

    def editCreditCard(self, name: Optional[str] = None, expDate: Optional[date] = None, cvv: Optional[int] = None):
        if name is not None:
            self.name = name
        if expDate is not None:
            self.expDate = expDate
        if cvv is not None:
            self.cvv = cvv