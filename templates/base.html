{% load static %}

<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>{% block title %}Game Store{% endblock %}</title>

    <!-- Main app styles -->
    <link rel="stylesheet" href="{% static 'css/app.css' %}">

    <style>
      /* simple styled flash messages */
      .tt-flash-container {
        margin-top: 16px;
        margin-bottom: 8px;
      }
      .tt-flash {
        padding: 8px 12px;
        border-radius: 8px;
        margin-bottom: 6px;
        font-size: 0.92rem;
        border: 1px solid rgba(255, 255, 255, 0.08);
      }
      .tt-flash-info {
        background: #1f2933;
      }
      .tt-flash-success {
        background: #064e3b;
      }
      .tt-flash-error {
        background: #7f1d1d;
      }
      .tt-flash-warning {
        background: #78350f;
      }

      /* make chip behave as clickable when it's a link */
      .tt-chip-link {
        text-decoration: none;
      }
      .tt-chip-link:hover {
        text-decoration: none;
        filter: brightness(1.05);
      }
    </style>
  </head>
  <body>
    <!-- HEADER / NAVBAR -->
    <header class="tt-header">
      <div class="tt-container">
        <div class="tt-header-inner">

          <!-- Brand: always goes to product list -->
          <a href="{% url 'product_list' %}" class="tt-brand">
            <span class="tt-logo">🎮</span>
            <span>Game Store</span>
          </a>

          <!-- Search: submits ?q=... to product_list -->
          <form class="tt-search" method="get" action="{% url 'product_list' %}">
            <input
              class="tt-search-input"
              type="text"
              name="q"
              placeholder="Search (demo only)"
              value="{{ request.GET.q|default_if_none:'' }}"
            >
            <button type="submit" class="tt-btn tt-btn-ghost">
              Search
            </button>
          </form>

          <!-- Right-side actions -->
          <div class="tt-actions">
            <!-- Cart button -->
            <a href="{% url 'cart_detail' %}" class="tt-btn tt-btn-ghost">
              🛒 Cart
            </a>

            <!-- Events button -->
            <a href="{% url 'event_list' %}" class="tt-btn tt-btn-ghost">
              📅 Events
            </a>

            <!-- Rooms / Room Booking button -->
            <a href="{% url 'room_booking_list' %}" class="tt-btn tt-btn-ghost">
              🏠 Rooms
            </a>

            {% if user.is_authenticated %}
              {% if user.is_staff %}
                <!-- Staff only: add product -->
                <a href="{% url 'product_create' %}" class="tt-btn tt-btn-primary">
                  + Add Product
                </a>

                <!-- Staff: user chip links to Django admin dashboard -->
                <a href="{% url 'admin:index' %}" class="tt-chip tt-chip-link" title="Admin dashboard">
                  <div class="tt-chip-dot">
                    {{ user.username|first|upper }}
                  </div>
                  <span>{{ user.username }}</span>
                </a>
              {% else %}
                <!-- Non-staff: chip is just display -->
                <div class="tt-chip">
                  <div class="tt-chip-dot">
                    {{ user.username|first|upper }}
                  </div>
                  <span>{{ user.username }}</span>
                </div>
              {% endif %}

              <!-- Logout -->
              <a href="{% url 'logout' %}" class="tt-btn tt-btn-ghost">
                Logout
              </a>
            {% else %}
              <!-- Not logged in: show Login / Signup -->
              <a href="{% url 'login' %}" class="tt-btn tt-btn-ghost">
                Login
              </a>
              <a href="{% url 'signup' %}" class="tt-btn tt-btn-primary">
                Sign up
              </a>
            {% endif %}
          </div>
        </div>
      </div>
    </header>

    <!-- MAIN PAGE CONTENT -->
    <main class="tt-page">
      <div class="tt-container page-content">

        {% if messages %}
          <div class="tt-flash-container">
            {% for message in messages %}
              <div class="tt-flash tt-flash-{{ message.tags|default:'info' }}">
                {{ message }}
              </div>
            {% endfor %}
          </div>
        {% endif %}

        {% block content %}{% endblock %}
      </div>
    </main>
  </body>
</html>
