{% extends "base.html" %}
{% load static %}

{% block title %}Your Cart – Game Store{% endblock %}

{% block content %}
  <main class="tt-page tt-detail-page">
    <div class="tt-container">
      <h1>Your Cart</h1>

      {% if cart|length %}
        <table class="cart-table">
          <thead>
            <tr>
              <th>Item</th>
              <th>Price</th>
              <th>Quantity</th>
              <th class="cart-line-price">Line Total</th>
              <th></th>
            </tr>
          </thead>
          <tbody>
            {% for item in cart %}
              <tr>
                <td>{{ item.product.name }}</td>
                <td>${{ item.price }}</td>
                <td>
                    <form action="{% url 'cart_update' item.product.id %}" method="post" class="cart-qty-form">
                        {% csrf_token %}
                        <button
                        type="submit"
                        name="direction"
                        value="down"
                        class="cart-qty-btn"
                        >
                        ↓
                        </button>

                        <span class="cart-qty-value">{{ item.quantity }}</span>

                        <button
                        type="submit"
                        name="direction"
                        value="up"
                        class="cart-qty-btn"
                        >
                        ↑
                        </button>
                    </form>
                </td>
                <td class="cart-line-price">
                  ${{ item.total_price }}
                </td>
                <td>
                  <form action="{% url 'cart_remove' item.product.id %}" method="post">
                    {% csrf_token %}
                    <button type="submit" class="btn btn-sm btn-danger">
                      Remove
                    </button>
                  </form>
                </td>
              </tr>
            {% endfor %}
          </tbody>
        </table>

        <p class="cart-summary">
          Cart total: <strong>${{ cart.get_total_price }}</strong>
        </p>

        <p class="cart-actions-row">
          <a href="{% url 'product_list' %}" class="btn btn-secondary btn-sm">
            ← Continue Shopping
          </a>
          <!-- placeholder checkout button -->
          <button class="btn btn-primary btn-sm" type="button">
            Checkout (demo)
          </button>
        </p>
      {% else %}
        <p>Your cart is empty.</p>
        <p>
          <a href="{% url 'product_list' %}" class="btn btn-primary btn-sm">
            Browse Products
          </a>
        </p>
      {% endif %}
    </div>
  </main>
{% endblock %}
